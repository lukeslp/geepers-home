/* Geepers — ambient sensor dashboard
   Target: 800x480 kiosk touchscreen on Raspberry Pi
   Aesthetic: dark neumorphic — soft shadows, embossed surfaces, tactile depth
   Layout: multi-view kiosk with tab switcher, split mode, immersive chat */

@import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap');

:root {
  /* Dark neumorphic surface palette */
  --bg-base: #1e2028;
  --bg-raised: #262930;
  --bg-sunken: #181a20;
  --bg-input: #1c1f26;

  /* Neumorphic shadows (top-left light source, dark mode) */
  --shadow-light: #2a2d35;
  --shadow-dark: #141620;
  --neo-out: 3px 3px 6px var(--shadow-dark), -3px -3px 6px var(--shadow-light);
  --neo-out-sm: 2px 2px 4px var(--shadow-dark), -2px -2px 4px var(--shadow-light);
  --neo-in: inset 3px 3px 6px var(--shadow-dark), inset -3px -3px 6px var(--shadow-light);
  --neo-in-sm: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
  --neo-flat: 2px 2px 5px var(--shadow-dark), -2px -2px 5px var(--shadow-light);

  /* Accent colors — slightly brighter for dark backgrounds */
  --accent: #7a9cc0;
  --accent-warm: #d4944e;
  --accent-warm-soft: rgba(212, 148, 78, 0.15);
  --accent-cool: #6ab0c0;

  /* Status colors — vibrant enough against dark */
  --good: #6eb880;
  --warn: #d4a050;
  --alert: #d26565;
  --alert-glow: rgba(210, 101, 101, 0.15);

  /* Text hierarchy (inverted for dark mode) */
  --text-primary: #e0e4ea;
  --text-secondary: #a0a8b8;
  --text-dim: #6a7282;
  --text-value: #f0f2f5;

  /* Borders */
  --border: rgba(100, 110, 130, 0.25);

  /* Overlay backdrop */
  --overlay-bg: rgba(30, 32, 40, 0.88);

  /* Spacing (4px grid) */
  --sp-1: 4px;
  --sp-2: 8px;
  --sp-3: 12px;
  --sp-4: 16px;
  --sp-5: 20px;
  --sp-6: 24px;

  /* Transitions */
  --ease: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --chat-transition: 400ms var(--ease);

  /* Radii */
  --radius: 12px;
  --radius-sm: 8px;
  --radius-pill: 24px;

  /* View system */
  --panel-header-h: 24px;
  --divider-w: 24px;
  --context-strip-w: 110px;
  --chip-h: 28px;
  --chip-font: 12px;
  --input-compact-h: 36px;
  --input-expanded-h: 84px;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

html, body {
  width: 800px;
  height: 480px;
  overflow: hidden;
  font-family: 'Outfit', system-ui, -apple-system, sans-serif;
  background: var(--bg-base);
  color: var(--text-primary);
  font-size: 17px;
  line-height: 1.4;
  user-select: none;
  -webkit-user-select: none;
  cursor: default;
}

/* ═══════════════════════════════════════
   LAYOUT — Multi-view kiosk
   grid: header | views | input
   ═══════════════════════════════════════ */

.dashboard {
  display: grid;
  width: 800px;
  height: 480px;
  grid-template-rows: 36px 1fr var(--input-compact-h);
}

.dashboard.chat-active {
  grid-template-rows: 36px 1fr var(--input-expanded-h);
}

/* ═══════════════════════════════════════
   HEADER BAR
   ═══════════════════════════════════════ */

.header {
  display: flex;
  align-items: center;
  gap: var(--sp-2);
  padding: 0 var(--sp-3);
  background: var(--bg-base);
  z-index: 10;
}

.header-title {
  font-weight: 700;
  font-size: 15px;
  color: var(--text-primary);
  letter-spacing: 0.5px;
  text-transform: uppercase;
  flex-shrink: 0;
}

/* ─── View Tabs ─── */
.view-tabs {
  display: flex;
  align-items: center;
  gap: var(--sp-1);
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
  flex: 1;
  min-width: 0;
  padding: 2px 0;
}

.view-tabs::-webkit-scrollbar { display: none; }

.view-tab {
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  padding: 5px 14px;
  border-radius: var(--radius-pill);
  font-family: inherit;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-dim);
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
  flex-shrink: 0;
}

.view-tab:active {
  box-shadow: var(--neo-in-sm);
}

.view-tab.active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-warm);
  font-weight: 600;
}

/* ─── Split Toggle ─── */
.split-toggle {
  width: 28px;
  height: 28px;
  border: none;
  border-radius: var(--radius-sm);
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--text-dim);
  font-size: 16px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
}

.split-toggle:active {
  box-shadow: var(--neo-in-sm);
}

.split-toggle.active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-cool);
}

/* ─── Chat Back Button ─── */
.chat-back-btn {
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  padding: 3px 10px;
  border-radius: var(--radius-pill);
  font-family: inherit;
  font-size: 12px;
  font-weight: 600;
  color: var(--accent-cool);
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
  flex-shrink: 0;
}

.chat-back-btn:active {
  box-shadow: var(--neo-in-sm);
}

.header-status {
  display: flex;
  align-items: center;
  gap: var(--sp-2);
  font-size: 13px;
  color: var(--text-secondary);
  flex-shrink: 0;
}

.header-status .dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--good);
  box-shadow: 0 0 4px var(--good);
  animation: pulse-dot 3s ease-in-out infinite;
}

.header-status .dot.warn {
  background: var(--warn);
  box-shadow: 0 0 4px var(--warn);
}
.header-status .dot.alert {
  background: var(--alert);
  box-shadow: 0 0 4px var(--alert);
  animation: pulse-alert 1s ease-in-out infinite;
}

/* Sensor count — clickable, opens all-sensors overlay */
.sensor-count-btn {
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  padding: 3px 10px;
  border-radius: var(--radius-pill);
  font-family: inherit;
  font-size: 13px;
  font-weight: 500;
  font-variant-numeric: tabular-nums;
  color: var(--text-secondary);
  cursor: pointer;
  transition: box-shadow 0.15s var(--ease), color 0.2s var(--ease);
  touch-action: manipulation;
}

.sensor-count-btn:active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-warm);
}

/* Radio badges (WiFi / BLE counts) */
.radio-badge {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-dim);
  background: var(--bg-base);
  padding: 3px 10px;
  border-radius: var(--radius-pill);
  box-shadow: var(--neo-out-sm);
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
  cursor: pointer;
  transition: color 0.3s var(--ease), box-shadow 0.15s var(--ease);
}

.radio-badge:active {
  box-shadow: var(--neo-in-sm);
}

.radio-badge.active {
  color: var(--accent-cool);
}

.clock {
  font-variant-numeric: tabular-nums;
  font-weight: 600;
  color: var(--text-primary);
}

/* ═══════════════════════════════════════
   VIEWS CONTAINER — holds all view panels
   ═══════════════════════════════════════ */

.views-container {
  position: relative;
  overflow: hidden;
}

.view-panel {
  display: none;
  position: absolute;
  inset: 0;
  overflow: hidden;
}

.view-panel.active {
  display: flex;
  flex-direction: column;
  animation: fade-in 0.15s var(--ease);
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

.view-panel iframe {
  width: 100%;
  height: 100%;
  border: none;
  background: var(--bg-sunken);
  border-radius: var(--radius-sm);
}

/* ─── Split mode ─── */
.views-container.split-mode {
  display: grid;
  grid-template-columns: 1fr var(--divider-w) 1fr;
}

.views-container.split-mode .view-panel {
  position: relative;
  display: flex;
  flex-direction: column;
}

.views-container.split-mode .view-panel:not(.split-left):not(.split-right) {
  display: none;
}

.panel-divider {
  background: var(--bg-base);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.2s var(--ease);
  touch-action: manipulation;
}

.panel-divider::after {
  content: '';
  width: 4px;
  height: 32px;
  border-radius: 2px;
  background: var(--text-dim);
  opacity: 0.3;
}

.panel-divider:active::after {
  opacity: 0.6;
}

/* Split panel mini-headers */
.panel-mini-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: var(--panel-header-h);
  padding: 0 var(--sp-2);
  background: var(--bg-raised);
  flex-shrink: 0;
}

.panel-view-select {
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-family: inherit;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
}

.panel-maximize-btn {
  border: none;
  background: transparent;
  color: var(--text-dim);
  font-size: 14px;
  cursor: pointer;
  padding: 2px;
  touch-action: manipulation;
}

/* ─── Chat mode overlay ─── */
.chat-mode {
  position: absolute;
  inset: 0;
  display: grid;
  grid-template-columns: var(--context-strip-w) 1fr;
  background: var(--bg-sunken);
  animation: fade-in 0.3s var(--ease);
  z-index: 20;
}

.context-strip {
  display: flex;
  flex-direction: column;
  gap: var(--sp-2);
  padding: var(--sp-2);
  overflow-y: auto;
  background: var(--bg-base);
  border-right: 1px solid var(--border);
  scrollbar-width: none;
}

.context-strip::-webkit-scrollbar { display: none; }

.context-chip {
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  border-radius: var(--radius-sm);
  padding: var(--sp-2);
  display: flex;
  flex-direction: column;
  gap: 2px;
  cursor: pointer;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
}

.context-chip:active {
  box-shadow: var(--neo-in-sm);
}

.context-chip.active {
  box-shadow: var(--neo-in-sm);
  border-left: 2px solid var(--accent-warm);
}

.chip-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.chip-value {
  font-size: 18px;
  font-weight: 700;
  color: var(--text-value);
  font-variant-numeric: tabular-nums;
}

.chat-area {
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* ═══════════════════════════════════════
   NEWS TICKER (inside sensors view)
   ═══════════════════════════════════════ */

.news-ticker {
  display: flex;
  align-items: center;
  gap: var(--sp-3);
  padding: 2px var(--sp-4);
  height: 24px;
  background: var(--bg-base);
  overflow: hidden;
  cursor: pointer;
  flex-shrink: 0;
}

.ticker-section {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: var(--accent-warm);
  white-space: nowrap;
  flex-shrink: 0;
  background: var(--accent-warm-soft);
  padding: 2px 8px;
  border-radius: var(--radius-sm);
}

.ticker-headline {
  font-size: 15px;
  font-weight: 400;
  color: var(--text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex: 1;
  transition: opacity 0.3s var(--ease);
}

.ticker-headline.fade {
  opacity: 0;
}

.news-ticker:active .ticker-headline {
  color: var(--text-primary);
}

/* ═══════════════════════════════════════
   SENSOR GRID — 4x2 inside sensors view
   ═══════════════════════════════════════ */

.sensor-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(2, 1fr);
  gap: var(--sp-3);
  padding: var(--sp-3);
  height: 100%;
}

/* ─── News feed view ─── */
.news-feed {
  padding: var(--sp-3);
  overflow-y: auto;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: var(--sp-2);
}
.news-item {
  background: var(--bg-base);
  border-radius: var(--radius);
  padding: var(--sp-3) var(--sp-4);
  box-shadow: var(--neo-flat);
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.news-item .news-section {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--accent);
}
.news-item .news-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-primary);
  text-decoration: none;
  line-height: 1.3;
}
.news-item .news-title:active { color: var(--accent); }
.news-item .news-abstract {
  font-size: 12px;
  color: var(--text-secondary);
  line-height: 1.4;
}

/* ─── Environment / System grid views ─── */
.environment-grid,
.system-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-auto-rows: minmax(80px, 1fr);
  gap: var(--sp-3);
  padding: var(--sp-3);
  height: 100%;
  overflow-y: auto;
}

.sensor-card {
  background: var(--bg-base);
  border-radius: var(--radius);
  padding: var(--sp-3) var(--sp-4);
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 3px;
  cursor: pointer;
  transition: all 0.15s var(--ease);
  position: relative;
  overflow: hidden;
  min-width: 0;
  box-shadow: var(--neo-out);
}

.sensor-card:active {
  box-shadow: var(--neo-in);
  transform: scale(0.98);
}

/* Tap feedback */
.sensor-card.tapped {
  animation: tap-flash 0.35s var(--ease);
}

@keyframes tap-flash {
  0% { box-shadow: var(--neo-in); }
  100% { box-shadow: var(--neo-out); }
}

.sensor-card.alert {
  box-shadow: var(--neo-out), 0 0 0 2px var(--alert);
}

.sensor-label {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 1px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.sensor-value {
  font-size: 32px;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  color: var(--text-value);
  line-height: 1.1;
  white-space: nowrap;
}

.sensor-unit {
  font-size: 16px;
  font-weight: 400;
  color: var(--text-secondary);
}

.sensor-trend {
  font-size: 13px;
  color: var(--text-dim);
  display: flex;
  align-items: center;
  gap: 3px;
}

.trend-up { color: var(--warn); }
.trend-down { color: var(--accent-cool); }
.trend-stable { color: var(--good); }


/* ─── Camera Card (replaces "All Sensors" card) ─── */
.camera-card {
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: var(--sp-2);
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.camera-thumb {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: calc(var(--radius) - 4px);
  position: absolute;
  inset: 0;
  z-index: 0;
  background: var(--bg-sunken);
}

.camera-card .sensor-label {
  position: relative;
  z-index: 1;
  background: rgba(30, 32, 40, 0.92);
  padding: 2px 8px;
  border-radius: var(--radius-sm);
  backdrop-filter: blur(4px);
}

.camera-card .sensor-trend {
  position: relative;
  z-index: 1;
  background: rgba(30, 32, 40, 0.92);
  padding: 1px 6px;
  border-radius: var(--radius-sm);
  backdrop-filter: blur(4px);
}

.camera-live {
  position: absolute;
  top: 6px;
  right: 6px;
  z-index: 1;
  font-size: 9px;
  font-weight: 700;
  color: var(--alert);
  background: rgba(30, 32, 40, 0.92);
  padding: 1px 5px;
  border-radius: var(--radius-sm);
  backdrop-filter: blur(4px);
  letter-spacing: 0.5px;
}

/* ─── System Progress Bars ─── */
.sys-bar {
  width: 100%;
  height: 6px;
  background: var(--bg-sunken);
  border-radius: 3px;
  overflow: hidden;
  margin-top: 4px;
  box-shadow: var(--neo-in-sm);
}

.sys-bar-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 0.6s var(--ease), background 0.3s var(--ease);
}

/* ─── Weather Card (spans 2 cols) ─── */
.weather-card {
  grid-column: span 2;
  flex-direction: row;
  gap: var(--sp-3);
  padding: var(--sp-3) var(--sp-4);
}

.weather-left {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-width: 60px;
  flex-shrink: 0;
}

.weather-icon {
  font-size: 32px;
  line-height: 1;
  margin: 2px 0;
}

.weather-desc {
  font-size: 13px;
  color: var(--text-secondary);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 70px;
}

.weather-right {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 2px;
  min-width: 0;
}

.weather-compare {
  display: flex;
  align-items: center;
  gap: var(--sp-2);
}

.weather-col {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
}

.weather-col-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.weather-temp {
  font-size: 22px;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  color: var(--text-value);
  line-height: 1.1;
}

.weather-humid {
  font-size: 14px;
  color: var(--text-secondary);
}

.weather-divider {
  width: 1px;
  height: 32px;
  background: var(--shadow-dark);
  opacity: 0.3;
  flex-shrink: 0;
}

.weather-meta {
  display: flex;
  gap: var(--sp-3);
  font-size: 14px;
  color: var(--text-dim);
  justify-content: center;
}

.weather-unit {
  font-size: 14px;
  font-weight: 400;
  color: var(--text-secondary);
}

/* ─── Comfort Score Card ─── */
.comfort-card {
  align-items: center;
  text-align: center;
  padding: var(--sp-3);
}

.comfort-gauge {
  position: relative;
  width: 60px;
  height: 34px;
}

.comfort-arc {
  width: 100%;
  height: 100%;
  display: block;
}

.comfort-score {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  font-size: 26px;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  color: var(--text-value);
  line-height: 1;
}

.comfort-label {
  font-size: 13px;
  color: var(--text-secondary);
  white-space: nowrap;
  margin-top: 1px;
}

/* ─── All Sensors Overlay ─── */
.sensor-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 800px;
  height: 480px;
  background: var(--overlay-bg);
  backdrop-filter: blur(6px);
  z-index: 150;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fade-in 0.2s var(--ease);
}

.sensor-overlay-content {
  width: 740px;
  max-height: 440px;
  background: var(--bg-base);
  border-radius: var(--radius);
  box-shadow: var(--neo-out), 0 8px 32px rgba(0,0,0,0.3);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.sensor-overlay-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--sp-3) var(--sp-4);
}

.sensor-overlay-title {
  font-size: 16px;
  font-weight: 700;
  color: var(--text-primary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.sensor-overlay-close {
  width: 34px;
  height: 34px;
  border-radius: var(--radius-sm);
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--text-secondary);
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  touch-action: manipulation;
}

.sensor-overlay-close:active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-warm);
}

.sensor-overlay-body {
  flex: 1;
  overflow-y: auto;
  padding: var(--sp-3) var(--sp-4);
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--sp-3);
  align-content: start;
}

.all-sensor-item {
  background: var(--bg-base);
  border-radius: var(--radius);
  box-shadow: var(--neo-out-sm);
  padding: var(--sp-3);
  display: flex;
  flex-direction: column;
  gap: 2px;
  cursor: pointer;
  transition: all 0.15s var(--ease);
}

.all-sensor-item:active {
  box-shadow: var(--neo-in-sm);
  transform: scale(0.97);
}

.all-sensor-item .sensor-label {
  font-size: 11px;
}

.all-sensor-item .sensor-value {
  font-size: 22px;
}

.all-sensor-item .sensor-unit {
  font-size: 13px;
}

.all-sensor-item .sensor-trend {
  font-size: 11px;
}

/* Breathing animation for live data */
@keyframes breathe {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.85; }
}

.sensor-card[data-live="true"] .sensor-value {
  animation: breathe 4s ease-in-out infinite;
}

/* ═══════════════════════════════════════
   SUGGESTION CHIPS — above input in chat mode
   ═══════════════════════════════════════ */

.suggestion-chips {
  display: flex;
  gap: var(--sp-2);
  padding: var(--sp-1) var(--sp-2) 0;
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.suggestion-chips::-webkit-scrollbar { display: none; }

.chip {
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  padding: 4px 12px;
  border-radius: var(--radius-pill);
  font-family: inherit;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-secondary);
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
  flex-shrink: 0;
}

.chip:active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-warm);
}

.chat-messages {
  flex: 1;
  overflow-y: auto;
  padding: var(--sp-3) var(--sp-4);
  scroll-behavior: smooth;
  display: flex;
  flex-direction: column;
  gap: var(--sp-3);
}

.chat-messages::-webkit-scrollbar {
  width: 3px;
}
.chat-messages::-webkit-scrollbar-track {
  background: transparent;
}
.chat-messages::-webkit-scrollbar-thumb {
  background: var(--shadow-dark);
  border-radius: 2px;
  opacity: 0.4;
}

.chat-msg {
  max-width: 90%;
  font-size: 16px;
  line-height: 1.5;
  animation: msg-in 0.3s var(--ease-spring);
}

.chat-msg.assistant {
  color: var(--text-primary);
  padding: var(--sp-2) var(--sp-3);
  background: var(--bg-raised);
  border-radius: 4px var(--radius) var(--radius) var(--radius);
  box-shadow: var(--neo-flat);
}

.chat-msg.user {
  align-self: flex-end;
  color: var(--text-primary);
  padding: var(--sp-2) var(--sp-3);
  background: var(--bg-base);
  border-radius: var(--radius) 4px var(--radius) var(--radius);
  box-shadow: var(--neo-out-sm);
  border-right: 2px solid var(--accent-cool);
}

.chat-msg.system {
  align-self: center;
  color: var(--text-dim);
  font-size: 14px;
  font-style: italic;
}

/* Markdown styles inside chat messages */
.chat-msg code {
  font-family: 'Courier New', monospace;
  font-size: 0.88em;
  background: var(--bg-sunken);
  padding: 1px 5px;
  border-radius: 4px;
  color: var(--accent);
}

.chat-msg pre {
  margin: 6px 0;
  padding: 8px 10px;
  background: var(--bg-sunken);
  border-radius: var(--radius-sm);
  box-shadow: var(--neo-in-sm);
  overflow-x: auto;
  line-height: 1.4;
}

.chat-msg pre code {
  background: none;
  padding: 0;
  font-size: 0.85em;
  color: var(--text-primary);
}

.chat-msg strong {
  font-weight: 600;
  color: var(--text-value);
}

.chat-msg em {
  font-style: italic;
  color: var(--text-secondary);
}

/* Streaming cursor */
.chat-msg.streaming::after {
  content: '';
  display: inline-block;
  width: 2px;
  height: 14px;
  background: var(--accent-warm);
  margin-left: 2px;
  vertical-align: text-bottom;
  animation: blink 0.8s step-end infinite;
}

/* ═══════════════════════════════════════
   INPUT BAR — mic + text input + send
   ═══════════════════════════════════════ */

.input-bar {
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: 0 var(--sp-3);
  background: var(--bg-base);
  z-index: 60;
  overflow: hidden;
}

.input-row {
  display: flex;
  align-items: center;
  gap: var(--sp-2);
  padding: var(--sp-1) 0;
}

.chat-input-wrap {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
}

.chat-input {
  width: 100%;
  height: 36px;
  padding: 0 44px 0 var(--sp-4);
  border-radius: var(--radius-pill);
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-in);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 17px;
  outline: none;
  transition: box-shadow 0.2s var(--ease);
}

.chat-input::placeholder {
  color: var(--text-dim);
}

.chat-input:focus {
  box-shadow: var(--neo-in), 0 0 0 2px rgba(106, 140, 175, 0.2);
}

.send-btn {
  position: absolute;
  right: 3px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--accent-warm);
  font-size: 16px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
}

.send-btn:active {
  box-shadow: var(--neo-in-sm);
  transform: scale(0.9);
}

.send-btn:disabled {
  opacity: 0.3;
  cursor: default;
}

/* Mic button — neumorphic circle, always visible */
.mic-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--accent-cool);
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
}

.mic-btn:active {
  box-shadow: var(--neo-in-sm);
}

.mic-btn.listening {
  color: var(--accent-warm);
  box-shadow: var(--neo-in-sm);
  animation: mic-pulse 1s ease-in-out infinite;
}

.mic-btn.processing {
  color: var(--accent-cool);
  box-shadow: var(--neo-in-sm);
  animation: mic-spin 1s linear infinite;
}

.mic-btn.speaking {
  color: var(--accent-cool);
  animation: mic-pulse 0.8s ease-in-out infinite;
}

.mic-btn.error {
  color: var(--alert);
}

.mic-btn.unavailable {
  opacity: 0.3;
  cursor: default;
}

@keyframes mic-pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(1.06); }
}

@keyframes mic-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ═══════════════════════════════════════
   CAMERA OVERLAY
   ═══════════════════════════════════════ */

.camera-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 800px;
  height: 480px;
  background: var(--overlay-bg);
  backdrop-filter: blur(6px);
  z-index: 150;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fade-in 0.2s var(--ease);
}

.camera-overlay-content {
  width: 720px;
  max-height: 440px;
  background: var(--bg-base);
  border-radius: var(--radius);
  box-shadow: var(--neo-out), 0 8px 32px rgba(0,0,0,0.3);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.camera-overlay-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--sp-3) var(--sp-4);
}

.camera-overlay-title {
  font-size: 16px;
  font-weight: 700;
  color: var(--text-primary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.camera-overlay-close {
  width: 34px;
  height: 34px;
  border-radius: var(--radius-sm);
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--text-secondary);
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  touch-action: manipulation;
}

.camera-overlay-close:active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-warm);
}

.camera-overlay-body {
  flex: 1;
  display: flex;
  gap: var(--sp-3);
  padding: 0 var(--sp-4) var(--sp-4);
  overflow: hidden;
}

.camera-feed {
  width: 320px;
  height: 240px;
  border-radius: var(--radius);
  box-shadow: var(--neo-in);
  object-fit: cover;
  background: var(--bg-sunken);
  flex-shrink: 0;
}

.camera-side {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--sp-3);
  min-width: 0;
}

.camera-describe-btn {
  padding: var(--sp-3) var(--sp-4);
  border-radius: var(--radius-pill);
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--accent);
  font-size: 15px;
  font-family: inherit;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s var(--ease);
  touch-action: manipulation;
  flex-shrink: 0;
}

.camera-describe-btn:active {
  box-shadow: var(--neo-in-sm);
}

.camera-describe-btn:disabled {
  opacity: 0.4;
  cursor: default;
}

.camera-description {
  flex: 1;
  overflow-y: auto;
  font-size: 15px;
  line-height: 1.5;
  color: var(--text-secondary);
  padding: var(--sp-3);
  background: var(--bg-sunken);
  border-radius: var(--radius-sm);
  box-shadow: var(--neo-in-sm);
}

/* ═══════════════════════════════════════
   ANIMATIONS
   ═══════════════════════════════════════ */

@keyframes pulse-dot {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

@keyframes pulse-alert {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(1.3); }
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

@keyframes msg-in {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Sensor value update flash */
@keyframes value-flash {
  0% { color: var(--accent-warm); }
  100% { color: var(--text-value); }
}

.sensor-value.updated {
  animation: value-flash 0.6s var(--ease);
}

/* ═══════════════════════════════════════
   LOADING STATE
   ═══════════════════════════════════════ */

.sensor-card.loading .sensor-value {
  opacity: 0.3;
  animation: pulse-load 1.5s ease-in-out infinite;
}

@keyframes pulse-load {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.5; }
}

/* ═══════════════════════════════════════
   ALERT TOASTS
   ═══════════════════════════════════════ */

#toast-container {
  position: fixed;
  top: 46px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 100;
  display: flex;
  flex-direction: column;
  gap: var(--sp-2);
  pointer-events: none;
  width: 90%;
  max-width: 600px;
}

.toast {
  padding: var(--sp-3) var(--sp-4);
  border-radius: var(--radius);
  font-size: 14px;
  line-height: 1.4;
  color: var(--text-primary);
  pointer-events: auto;
  cursor: pointer;
  animation: toast-in 0.3s var(--ease-spring);
  background: var(--bg-base);
  box-shadow: var(--neo-out), 0 4px 12px rgba(0, 0, 0, 0.08);
}

.toast-info {
  border-left: 3px solid var(--accent-cool);
}

.toast-warn {
  border-left: 3px solid var(--warn);
}

.toast-critical {
  border-left: 3px solid var(--alert);
}

.toast-exit {
  animation: toast-out 0.4s var(--ease) forwards;
}

@keyframes toast-in {
  from {
    opacity: 0;
    transform: translateY(-12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes toast-out {
  from {
    opacity: 1;
    transform: translateY(0);
  }
  to {
    opacity: 0;
    transform: translateY(-12px);
  }
}

/* ═══════════════════════════════════════
   ONSCREEN KEYBOARD
   ═══════════════════════════════════════ */

.osk {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 800px;
  background: var(--bg-base);
  padding: var(--sp-1) var(--sp-2);
  z-index: 200;
  display: flex;
  flex-direction: column;
  gap: 3px;
  box-shadow: 0 -4px 16px rgba(0,0,0,0.25);
}

.osk-row {
  display: flex;
  gap: 3px;
  justify-content: center;
}

.osk-key {
  height: 38px;
  min-width: 38px;
  padding: 0 6px;
  border: none;
  border-radius: var(--radius-sm);
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 17px;
  font-weight: 500;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex: 1;
  max-width: 72px;
  transition: all 0.1s var(--ease);
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

.osk-key:active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-warm);
  transform: scale(0.93);
}

.osk-shift, .osk-bksp, .osk-num {
  flex: 1.3;
  max-width: 60px;
  font-size: 18px;
  color: var(--text-secondary);
}

.osk-shift.active {
  color: var(--accent-warm);
  box-shadow: var(--neo-in-sm);
}

.osk-space {
  flex: 5;
  max-width: none;
  font-size: 12px;
  color: var(--text-dim);
  letter-spacing: 1px;
  text-transform: uppercase;
}

.osk-send {
  flex: 1.5;
  max-width: 80px;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--accent-warm);
  font-weight: 600;
}

.osk-send:active {
  box-shadow: var(--neo-in-sm);
}

/* When keyboard is open, push the layout up */
body.osk-open .dashboard {
  height: 320px;
}

body.osk-open .input-bar {
  position: fixed;
  bottom: 165px;
  left: 0;
  width: 800px;
  z-index: 201;
}

body.osk-open .views-container {
  display: none;
}

/* Hide chat mode when keyboard is open (input takes priority) */
body.osk-open .chat-mode {
  display: none;
}

/* ═══════════════════════════════════════
   RADIO DETAIL OVERLAY
   ═══════════════════════════════════════ */

.radio-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 800px;
  height: 480px;
  background: var(--overlay-bg);
  backdrop-filter: blur(6px);
  z-index: 150;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fade-in 0.2s var(--ease);
}

.radio-overlay-content {
  width: 680px;
  max-height: 420px;
  background: var(--bg-base);
  border-radius: var(--radius);
  box-shadow: var(--neo-out), 0 8px 32px rgba(0,0,0,0.3);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.radio-overlay-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--sp-3) var(--sp-4);
}

.radio-overlay-title {
  font-size: 16px;
  font-weight: 700;
  color: var(--text-primary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.radio-overlay-close {
  width: 34px;
  height: 34px;
  border-radius: var(--radius-sm);
  border: none;
  background: var(--bg-base);
  box-shadow: var(--neo-out-sm);
  color: var(--text-secondary);
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  touch-action: manipulation;
}

.radio-overlay-close:active {
  box-shadow: var(--neo-in-sm);
  color: var(--accent-warm);
}

.radio-overlay-body {
  flex: 1;
  overflow-y: auto;
  padding: var(--sp-3) var(--sp-4);
}

/* Radio detail items */
.radio-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--sp-2) var(--sp-3);
  border-bottom: 1px solid var(--border);
}

.radio-item:last-child {
  border-bottom: none;
}

.radio-item-name {
  font-size: 14px;
  color: var(--text-primary);
  font-weight: 500;
}

.radio-item-meta {
  font-size: 12px;
  color: var(--text-secondary);
  display: flex;
  gap: var(--sp-3);
}

.radio-signal {
  font-variant-numeric: tabular-nums;
}

.radio-signal-bar {
  display: inline-block;
  width: 40px;
  height: 8px;
  background: var(--bg-sunken);
  border-radius: 4px;
  overflow: hidden;
  vertical-align: middle;
  box-shadow: var(--neo-in-sm);
}

.radio-signal-fill {
  height: 100%;
  border-radius: 4px;
  background: var(--good);
}

.radio-connected {
  color: var(--good);
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
}

.radio-summary {
  font-size: 13px;
  color: var(--text-secondary);
  padding: var(--sp-2) 0;
  border-bottom: 1px solid var(--border);
  margin-bottom: var(--sp-2);
}

.radio-summary strong {
  color: var(--text-primary);
}
